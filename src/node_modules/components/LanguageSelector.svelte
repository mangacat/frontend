<div class="relative w-64 mx-auto">
    <select class="form-select dark:bg-gray-800 dark:border-gray-600 block w-64 pl-10" bind:value={lang}>
        <option value="en-US">English (US)</option>
    </select>
    <div class="pointer-events-none absolute inset-y-0 left-0 pl-3 flex items-center">
        <svg class="fill-current pointer-events-none w-5 h-5 opacity-50" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M4.06 13a8 8 0 0 0 5.18 6.51A18.5 18.5 0 0 1 8.02 13H4.06zm0-2h3.96a18.5 18.5 0 0 1 1.22-6.51A8 8 0 0 0 4.06 11zm15.88 0a8 8 0 0 0-5.18-6.51A18.5 18.5 0 0 1 15.98 11h3.96zm0 2h-3.96a18.5 18.5 0 0 1-1.22 6.51A8 8 0 0 0 19.94 13zm-9.92 0c.16 3.95 1.23 7 1.98 7s1.82-3.05 1.98-7h-3.96zm0-2h3.96c-.16-3.95-1.23-7-1.98-7s-1.82 3.05-1.98 7zM12 22a10 10 0 1 1 0-20 10 10 0 0 1 0 20z"/>
        </svg>
    </div>
</div>

<script>
    import { locale, dictionary } from 'svelte-i18n'

    let lang = $locale

    $: translate(lang)

    async function translate(lang) {
    	if (!process.browser) return
        
    	if (!Object.keys($dictionary).includes(lang)) {
    		let res = await fetch(`/i18n/${lang}.json`)
    		res = await res.json()

    		const dict = { ...$dictionary }
    		dict[lang] = res
    		dictionary.set(dict)
    	}

    	locale.set(lang)
    }
</script>